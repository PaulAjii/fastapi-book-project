# FastAPI Book Management API

## Overview

This project is a RESTful API built with **FastAPI** for managing a book collection. It provides comprehensive **CRUD (Create, Read, Update, Delete)** operations for books, with proper error handling, input validation, and auto-generated API documentation. The application is designed to be deployed with a **CI/CD pipeline** and served using **Nginx** as a reverse proxy.

---

## Features

-   ğŸ“š **Book Management**: Full CRUD operations for managing books.
-   âœ… **Input Validation**: Uses **Pydantic** models for robust data validation.
-   ğŸ” **Genre Classification**: Books are categorized using an enum-based genre system.
-   ğŸ§ª **Test Coverage**: Includes comprehensive unit tests using **pytest**.
-   ğŸ“ **API Documentation**: Auto-generated by FastAPI (Swagger UI and ReDoc).
-   ğŸ”’ **CORS Middleware**: Enabled for secure cross-origin requests.
-   ğŸš€ **CI/CD Pipeline**: Automated testing and deployment using **GitHub Actions**.
-   ğŸŒ **Nginx Integration**: Serves the FastAPI application as a reverse proxy.

---

## Project Structure

```
fastapi-book-project/
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ schemas.py      # Data models and in-memory database
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ books.py        # Book route handlers
â”‚   â””â”€â”€ router.py           # API router configuration
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ config.py           # Application settings
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ test_books.py       # API endpoint tests
â”œâ”€â”€ main.py                 # Application entry point
â”œâ”€â”€ requirements.txt        # Project dependencies
â”œâ”€â”€ .github/workflows/      # GitHub Actions workflows
â”‚   â”œâ”€â”€ ci.yml              # CI pipeline for testing
â”‚   â””â”€â”€ cd.yml              # CD pipeline for deployment
â”œâ”€â”€ nginx.conf              # Nginx configuration file
â””â”€â”€ README.md
```

---

## Technologies Used

-   **Python 3.12**
-   **FastAPI**
-   **Pydantic**
-   **pytest**
-   **uvicorn**
-   **GitHub Actions**
-   **Nginx**

---

## Installation

1. **Clone the repository**:

    ```bash
    git clone https://github.com/hng12-devbotops/fastapi-book-project.git
    cd fastapi-book-project
    ```

2. **Create a virtual environment**:

    ```bash
    python -m venv venv
    source venv/bin/activate  # On Windows: venv\Scripts\activate
    ```

3. **Install dependencies**:

    ```bash
    pip install -r requirements.txt
    ```

---

## Running the Application Locally

1. **Start the server**:

    ```bash
    uvicorn main:app --reload
    ```

2. **Access the API documentation**:

    - **Swagger UI**: http://localhost:8000/docs
    - **ReDoc**: http://localhost:8000/redoc

---

## API Endpoints

### Books

-   `GET /api/v1/books/` - Get all books
-   `GET /api/v1/books/{book_id}` - Get a specific book by ID
-   `POST /api/v1/books/` - Create a new book
-   `PUT /api/v1/books/{book_id}` - Update a book
-   `DELETE /api/v1/books/{book_id}` - Delete a book

### Health Check

-   `GET /healthcheck` - Check API status

---

## Book Schema

```json
{
	"id": 1,
	"title": "Book Title",
	"author": "Author Name",
	"publication_year": 2024,
	"genre": "Fantasy"
}
```

### Available Genres

-   Science Fiction
-   Fantasy
-   Horror
-   Mystery
-   Romance
-   Thriller

---

## Running Tests

To run the test suite, use the following command:

```bash
pytest
```

---

## Error Handling

The API includes proper error handling for:

-   Non-existent books
-   Invalid book IDs
-   Invalid genre types
-   Malformed requests

---

## CI/CD Pipeline

### Continuous Integration (CI)

-   **Trigger**: Runs on pull requests to the `main` branch.
-   **Job**: `test`
    -   Executes `pytest` to run the test suite.
    -   Fails if any tests do not pass.

### Continuous Deployment (CD)

-   **Trigger**: Runs on merging a pull request to the `main` branch.
-   **Job**: `deploy`
    -   Automatically deploys the application to the production server.

---

## Nginx Configuration

The FastAPI application is served using **Nginx** as a reverse proxy. Key settings include:

-   Proxy pass to the FastAPI application running on `localhost:8000`.
-   Handling of API requests and static files.

To apply the Nginx configuration:

```bash
sudo cp nginx.conf /etc/nginx/sites-available/fastapi-book-project
sudo ln -s /etc/nginx/sites-available/fastapi-book-project /etc/nginx/sites-enabled/
sudo systemctl restart nginx
```

---

## Deployment

1. **Set up the server**:

    - Install Python, FastAPI, and Nginx on the server.
    - Clone the repository and install dependencies.

2. **Run the application**:

    - Use `uvicorn` to start the FastAPI application.

3. **Configure Nginx**:

    - Update the `nginx.conf` file with the correct server details.
    - Restart Nginx to apply the changes.

4. **Enable CI/CD**:
    - Push changes to the `main` branch to trigger the deployment pipeline.

---

## Contributing

1. Fork the repository.
2. Create a feature branch (`git checkout -b feature/AmazingFeature`).
3. Commit your changes (`git commit -m 'Add AmazingFeature'`).
4. Push to the branch (`git push origin feature/AmazingFeature`).
5. Open a Pull Request.

---

## License

This project is licensed under the **MIT License**. See the [LICENSE](LICENSE) file for details.

---

## Support

For support, please open an issue in the [GitHub repository](https://github.com/hng12-devbotops/fastapi-book-project).

---

## Submission Details

### Base URL

The base URL the application is `http://ec2-51-20-53-161.eu-north-1.compute.amazonaws.com/`

---

### GitHub Repository

[GitHub Repository URL](https://github.com/hng12-devbotops/fastapi-book-project)
